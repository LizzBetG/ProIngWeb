<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<!-- 
	Template 2018 Notebook
    http://www.tooplate.com/view/2018-notebook
-->
<title>Notebook - Free HTML Template</title>
<meta name="keywords" content="" />
<meta name="description" content="" />
<link href="tooplate_style.css" rel="stylesheet" type="text/css" />
<link href="estilos.css" rel="stylesheet" type="text/css" />

<link rel="stylesheet" href="css/coda-slider.css" type="text/css" charset="utf-8" />

<script src="js/jquery-1.2.6.js" type="text/javascript"></script>
<script src="js/jquery.scrollTo-1.3.3.js" type="text/javascript"></script>
<script src="js/jquery.localscroll-1.2.5.js" type="text/javascript" charset="utf-8"></script>
<script src="js/jquery.serialScroll-1.2.1.js" type="text/javascript" charset="utf-8"></script>
<script src="js/coda-slider.js" type="text/javascript" charset="utf-8"></script>
<script src="js/jquery.easing.1.3.js" type="text/javascript" charset="utf-8"></script>

<!-- otraaaaaaaaaaaaaaaaassssssssssssssssssssss -->
<script type="text/javascript" src="d3.min.js"></script>
<script src="https://code.jquery.com/jquery-1.11.3.js"></script>

</head>
<body>
  <script>
    jQuery(document).ready(function($) {
      console.log('ready');
        jQuery.ajax({
          url: 'http://carbono.utpl.edu.ec:8080/RESTFUL_SICA/webresources/entidades.proyectos/listar?jsoncallback=?',
          // url:'http://carbono.utpl.edu.ec:8080/RESTFUL_SICA/webresources/entidades.proyectos/buscarPorCedula?cedula=1102809462&jsoncallback=?',
          type: 'POST',
          dataType: 'json',
          data: {},
          complete: function(xhr, textStatus) {
            //called when complete
            console.log("complete"+textStatus);
          },
          success: function(data, textStatus, xhr) {
            //called when successful
            // nombrecualquiera(data.proyectos);
            proyectoTipo(data.proyectos);
            contador(data.proyectos,tipoProyectoA,valor);
            graficar(data.proyectos,tipoProyectoA,valor);
          },
          error: function(xhr, textStatus, errorThrown) {
            console.log("error"+textStatus);        
          }
        });       
    });
  </script>
<div id="slider">
	<div id="tooplate_wrapper">
        <div id="tooplate_sidebar">
		
            <div id="header">
                <!-- <h1><a href="#"><img src="images/tooplate_logo.png" title="Notebook Template - tooplate.com" alt="Notebook free html template" /></a></h1> -->
            </div>    
			
            <div id="menu">
                <ul class="navigation">
                    <li><a href="#home" class="selected menu_01">Home</a></li>
                    <li><a href="#aboutus" class="menu_02">Diagrama de Barras</a></li>
                    <li><a href="#services" class="menu_03">Circulares</a></li>
                    <li><a href="#gallery" class="menu_04">Búsqueda </a></li>
                    <li><a href="#contactus" class="menu_05">Contact</a></li>
                </ul>
            </div>
		</div> <!-- end of sidebar -->  
    
        <div id="content">
          <div class="scroll">
            <div class="scrollContainer">
              <div class="panel" id="home">
                <div class="content_section">
                  <h1>Ingeniería Web</h1>
                  <br>
                  <h2><center>Implementación de D3.js</center></h2>
                  <img src="images/d3Logo.png" alt="Image 01" class="image_wrapper image_fl" />
                  <hr>
               <!--    <p><em>Nullam at erat ipsum, quis tincidunt mauris. Nunc sit amet sapien eget eros iaculis hendrerit quis a enim. Vestibulum at leo ante, vel auctor velit.</em></p>
                  <p>Notebook is designed by <a rel="nofollow" href="http://www.tooplate.com">Free HTML Templates</a>. Credits go to <a rel="nofollow" href="http://www.photovaco.com">Free Photos</a> for photos, <a rel="nofollow" href="http://jwloh.deviantart.com/art/Aquaticus-Social-91014249">jwloh</a> for Aquaticus social icons, and <a rel="nofollow" href="http://www.icojoy.com">icojoy.com</a> for icons used in this template. Morbi rutrum euismod elit, nec adipiscing ante sodales sed. Cras accumsan congue turpis a luctus.</p> -->
                  <br>
                  <p align="justify">
                     <a rel="nofollow" href="http://d3js.org/">D3.js</a>  es una librería JavaScript para manipular documentos basados en datos. D3 ayuda a traer datos a la vida usando HTML, SVG y CSS. Énfasis de D3 en estándares web te da todas las capacidades de los navegadores modernos sin engancharte a un propietario marco, combinando componentes de visualización de gran alcance y un enfoque orientado a datos manipulación DOM.
                  </p>
                </div>
                <div class="content_section last_section">
                  <h2>Servicio</h2>
                  </ul> -->
                  <p align="justify">
                    Para el presente proyecto se a tomado el web services que proporciona la UTPL a los estudiantes para la realización de sus trabajos de fin de ciclo.
                    <br>
                    Dicho web services trata sobre los <strong>proyectos</strong> que mantiene la universidad con los respectivos docentes internos o colaboradores externos.
                    <br>Para más información <a rel="nofollow" href="http://carbono.utpl.edu.ec:8080/RESTFUL_SICA/webresources/entidades.proyectos/listar">aquí</a>
                  </p>
                </div>
              </div> <!-- end of home -->
			  
              <div class="panel" id="aboutus">
                <div class="content_section">
                  <h1>Diagrama de Barras</h1>
                   <p>
                    El presente gráfico hace referencia a los tipos de proyectos que se han efectuado en dicha universidad y asi mismo informa cuantos proyectos se ahn efectuado por cada tipo.
                  </p>
                  <div class="Grafico"></div>                 
<script>
                  var tipoProyectoA=[];
                  var valor=[];
                  var registro=false;

                  function proyectoTipo(tp){
                    $.each(tp, function(i, tipoPro ){
                      var ingresar=true;
                      if(!registro){
                        tipoProyectoA.push(tipoPro.project_type);
                        valor.push(0);        
                        registro=true;
                      }else {
                        for (project_type in tipoProyectoA) {
                          if (tipoProyectoA[project_type]==tipoPro.project_type){
                            ingresar=false
                          };          
                        };
                        if (ingresar) {
                          tipoProyectoA.push(tipoPro.project_type);
                          valor.push(0);
                          console.log('val'+valor);
                        };
                      };
                    });
                  }
                  function contador(tp, tipoProyectoA, valor){
                    $.each(tp, function(i, tipoPro ){
                      for(proyectoTipo in tipoProyectoA){
                        if (tipoProyectoA[proyectoTipo]==tipoPro.project_type) {
                          valor[proyectoTipo]= valor[proyectoTipo] +1;
                        };
                      }
                    });
                  }
                  function graficar(tp, tipoProyectoA, valor){
                    d3.select('.Grafico')
                      .append('h5');
                      // .text('Tipos de proyecto');
                    var ancho=500, alto=(valor.length*35)+100;
                    var esAncho=d3.scale.linear().domain([0,Math.max.apply(null, valor)+20]).range([0,ancho]);
                    var esColor=d3.scale.linear().domain([0, 499]).range(['#EF0AEB', '#19EBC5']);

                    var canvas=d3.select('.Grafico')
                          // .attr("transform", "rotate(-90)")
                          .text('Tipo de Proyectos')
                          .append('svg')            
                            .attr('class','marco')
                            .attr('width',ancho)
                            .style('border-left','3px solid black')
                            .attr('height', alto)           
                            // .style('border-top','3px solid black')
                            .append('g')
                              .attr('transform','translate(0,20)')              
                            ;
                    console.log('el tamañao del array es : '+tipoProyectoA.length);

                    var GraBarras=canvas.selectAll('rect')
                            .text('numero')
                            .data(tipoProyectoA)

                            .enter()
                              .append('rect')
                              .attr('width','0')
                              .transition(50000)
                              .delay(800)
                              
                              .attr('width', function(i,j){
                              console.log('valor de d es ' +j);
                              return esAncho(valor[j]);
                            })
                            .attr('height',30)
                            .attr('fill',function(i,j){
                              return esColor(valor[j]);
                            })
                            .attr('y',function(j,i){
                              return i*35
                              console.log("...."+i*35);
                            })
                            .style("cursor","pointer")
                            

                            ;
                  var nombres= canvas.selectAll("text")
                          .data(tipoProyectoA)
                          .enter()
                            .append('text')
                              .attr('fill','black')
                              .attr('y',function(j,i){
                                return i*35+20;
                              })
                              .text(function(j,i){
                                return j + "("+valor[i]+")";  
                              }); 
                  }
</script>


                </div>

              </div> <!-- end of aboutus -->
			  
              <div class="panel" id="services">
                <h1>Circular</h1>
               <p>
                 Esta visualizacion representa que cada circulo es determinado por el precio de financiación de la UTPL.
               </p>
				
                <div class="cleaner_h20"></div>
				        <div class="circular"></div>
  
<script>
  var width = 560,
      height = 500,
      root;

    var force = d3.layout.force()
      .linkDistance(80)
      .charge(-10)
      .gravity(.05)
      .size([width, height])
      .on("tick", tick);

    var svg = d3.select(".circular").append("svg")
      .attr("width", width)
      .attr("height", height);

    var link = svg.selectAll(".link"),
      node = svg.selectAll(".node");

   d3.json("flare.json", function(error, json) {
      if (error) throw error;
      root = json;
      update();
  });

   function update(){
      var nodes = flatten(root),
          links = d3.layout.tree().links(nodes);
         force
           .nodes(nodes)
           .links(links)
           .start();
          //actualiza links
    link = link.data(links, function(d) { return d.target.id; });
    console.log(link);
      link.exit().remove(); 

      link.enter().insert("line", ".node")
        .attr("class", "link");
//actualkzia nosodos
      node = node.data(nodes, function(d) { return d.id; });
      node.exit().remove();   

      var nodeEnter = node.enter().append("g")
        .attr("class", "node")
        .on("click", click)
        .call(force.drag);

    nodeEnter.append("circle")
          .attr("r", function(d) { 
          //  return d.utpl_finance); 
          return Math.sqrt(d.utpl_finance) / 10 || 4.5;
        });

    nodeEnter.append("text")
        .attr("dy", ".35em")
        .text(function(d) { 
          return d.id; });
    node.select("circle")
          .style("fill", color);
   }//fin actualizar
   function tick() {
      link.attr("x1", function(d) { return d.source.x; })
        .attr("y1", function(d) { return d.source.y; })
        .attr("x2", function(d) { return d.target.x; })
        .attr("y2", function(d) { return d.target.y; });

      node.attr("transform", function(d) { return "translate(" + d.x + "," + d.y + ")"; });
  }//fin tick
  function color(d) {
    return d._proyectos ? "#040A22" // collapsed package
        : d.proyectos ? "#F0B0B0" // expanded package
        : "#AFEA5D"; // leaf node
  }

  function click(d) {
    if (d3.event.defaultPrevented) return; // ignore drag
        if (d.children) {
          d._children = d.children;
          d.children = null;
          
        } 
        else {
          d.children = d._children;
          d._children = null;
        }

        window.alert("Id \n: "+d.id +
          "\n\nNombre \n "+d.project_name+
          "\n\nTipo Proyecto \n"+d.project_type+
          "\n\nFinanciamiento utpl $ "+d.utpl_finance+  
          "\n\nAño : \n"+d.year
          );

      update();
  }

  function flatten(root) {
    var nodes = [], i = 0;

    function recurse(node) {
        if (node.proyectos) node.proyectos.forEach(recurse);
        if (!node.participantes) 
          //va id
          node.participantes = ++i;
          nodes.push(node);
      }

      recurse(root);
      return nodes;
  } 

</script>                

              </div> <!-- end of services -->
			  
              <div class="panel" id="gallery">
                <h1>Búsquedas por año</h1>
                <input type="text" id="b">
                <input type="button" id="buscar" value="Buscar">
                <div id="imagenes"></div>
                <script src="jquery.js"></script>
<script>
  $(document).on("ready",main);
    function main(){
      $("#buscar").on("click",function(){
        var texto="";
        var tag=$("#b").val();
        $("#imagenes").text("Cargando...");
        $.getJSON("http://carbono.utpl.edu.ec:8080/RESTFUL_SICA/webresources/entidades.proyectos/listar?jsoncallback=?",function(datos){
          $.each(datos.proyectos, function(i, item){
            if (tag == item.year) {
              texto +="<div class='cuadro'>";  
              texto +="<table>" +
                            "<tr>"+
                              "<td> <strong>Id :</strong> </td>"+
                              "<td> <strong>Nombre Proyecto :</strong> </td>"+
                              "<td> <strong>Año :</strong> </td>"+
                            "</tr>"+                          
                            "<tr>"+
                                "<td>"+item.id+"</td>"+
                                "<td>"+item.project_name+"</td>"+
                                "<td>"+item.year+"</td>"+
                             "</tr>"+                              
                      "</table>";
                            texto +="</div>";
            }
            else{
              alert("No existen proyectos del año "+tag);
            };            
          });
          $("#imagenes").html(texto);
        });
      });
    }
</script>


                
              </div>
			  
              <div class="panel" id="contactus">
                <h1>Contact Information</h1>
                <p>Duis vel est eu velit eleifend volutpat non et purus. Pellentesque tellus nulla, suscipit et fringilla vitae, sodales ultricies dolor.</p>
                <div class="cleaner_h10"></div>
				
                <div class="col_380 float_l">
                  <div id="contact_form">
                    <form method="post" name="contact" action="#">
                      <label for="author">Name:</label>
                      <input type="text" maxlength="40" id="author" class="input_field" name="author" />
                      <div class="cleaner_h10"></div>
                      <label for="email">Email:</label>
                      <input type="text" maxlength="40" id="email" class="input_field" name="email" />
                      <div class="cleaner_h10"></div>
                      <label for="subject">Subject:</label>
                      <input type="text" maxlength="40" id="subject" class="input_field" name="subject" />
                      <div class="cleaner_h10"></div>
                      <label for="text">Message:</label>
                      <textarea id="text" name="text" rows="0" cols="0" class="required"></textarea>
                      <div class="cleaner_h10"></div>
                      <input type="submit" value="Send" id="submit" name="submit" class="submit_btn float_l" />
                      <input type="reset" value="Reset" id="reset" name="reset" class="submit_btn float_r" />
                    </form>
                  </div>
                </div>
				
                <div class="col_380 float_r"> </div>
              </div>
            </div>
          </div><!-- end of scroll -->
		</div>
    </div> <!-- end of content -->
</div>

<div id="footer">
    
	<div id="social_box">
		<a href="#"><img src="images/facebook.png" alt="facebook" /></a>
        <a href="#"><img src="images/flickr.png" alt="flickr" /></a>
        <a href="#"><img src="images/myspace.png" alt="myspace" /></a>
        <a href="#"><img src="images/twitter.png" alt="twitter" /></a>
        <a href="#"><img src="images/youtube.png" alt="youtube" /></a>
    </div>
    
    <div id="footer_left">
		
		Copyright © 2048 <a href="#">Company Name</a><br />
		Designed by <a href="http://www.tooplate.com">Free HTML Templates</a><br />
       
    </div>
	
    <div class="cleaner"></div>
</div>


<!--------------------------------------------------------- /script-->


<!--   Free Website Template by t o o p l a t e . c o m   -->
</body>
</html>